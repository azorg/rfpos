Вычисление координат передатчика по задержкам сигнала до приёмников
===================================================================

## Постановка задачи

Предположим, что приёмники работают в системе единого времени (СЕВ).
Каждый из приёмников находится в точке с известными координатами.
Координаты могут быть на плоскости (d=2) или в пространстве (d=3).
Каждый из приёмников производит оценку времени приёма импульсного
сигнала передатчика в СЕВ.
Поставленной задачей является оценка координат передатчика на
основе произведенных оценок времени приёма приёмниками.

Предположим, что передатчик излучил импульсных сигнал в момент
времени t0 в СЕВ. Приёмники сформировали оценки момента приёма
сигнала t[1], ... t[n], где n - число приёмников, обнаруживших сигнал.

Обозначим известные координаты приёмников для d=3 как:
```
(x[1], y[1], z[1]), ... (x[n], y[n], z[n])
```

Обозначим координаты передатчика (для d=3): (x0, y0, z0).

Имеет место следующая система квадратных уравнений (n шт):
```
(x0 - x[i])^2 + (y0 - y[i])^2 + (z0 - z[i])^2 = (C * (t0 - t[i]))^2
```
где i = 1...n, а C - скорость распространения радиоволны (скорость света).

Данная система уравнений имеет 4 неизвестных (x0, y0, z0, t0) для случая d=3.
В случае d=2 (задача на плоскости) неизвестных будет 3: (x0, y0, t0).

Необходимым условиям для поиска единственного решения является n > d.
В случае, если n > d + 1 система уравнений получится "переопределенной"
(т.е. избыточной), что должно повысить точность оценки за счёт большего
усреднения случайных ошибок.

Миссией данного иллюстрационного проекта является разработка и отладка
алгоритма численного решения данной системы уравнений для случая d=2 и d=3.

## Введение обозначений

При решении задачи, можно выполнить перенос по времени, такой, что
за ноль отсчета часов принять минимальное  значение t[1]...t[n].
Это позволит уйти от "больших" чисел (больших мантисс) и, возможно,
позволит минимизировать потери точности при вычислениях.

Для того, чтобы уйти от величины скорости света C в системе уравнений можно
перейти от временных оценок к дальномерным.

Совершим переход от t[i] к d[i], где i=1...n:
```
Tmin = min{t[1], ..., t[n]}
d[1] = (t[1] - Tmin) * C
...
d[n] = (t[n] - Tmin) * C
```

Теперь система из n уравнений может быть представлена в следующем виде:
```
(x0 - x[i])^2 + (y0 - y[i])^2 + (z0 - z[i])^2 - (d0 - d[i]))^2 = 0 (1)
```
Необходимо найти решение данной системы относительно x0, y0, z0 и d0.

При нахождении d0, исходное значение t0 может быть вычислено следующим образом:
```
t0 = d0 / C + Tmin
```

Введем обозначения (для случая d=3):
```
искомый вектор X = (x0, y0, z0, d0) = (x0, x1, x2, x3) размерности d+1;

исходные данные в виде матрицы Y размера (d+1)*n:

    | y0[0]   y1[0]   y2[0]   y3[0]   |
Y = | ...     ...     ...     ...     |
    | y0[n-1] y1[n-1] y2[n-1] y3[n-1] |

где:
  y0[k] = x[k+1]
  y1[k] = y[k+1]
  y2[k] = z[k+1]
  y3[k] = d[k+1]
  k=0...n-1
  
Обозначим семейство функций f(X)[k] с номером k=0...n-1:

f(X)[k] = (x0 - x[i+1])^2 + (y0 - y[i+1])^2 + (z0 - z[i+1])^2 - (d0 - d[i+1]))^2
          (x0 - y0[i])^2 + (x1 - y1[i])^2 + (x2 - y2[i])^2 - (x3 - y3[i]))^2

F(X) = (f(X)[0], ... f(X)[n-1])', где ' - символ транспонирования
```
Поставленная задача сводится к нахождению вектора X для системы уравнений,
записанной в матричной форме: F(X) = 0.

Предлагается найти решение данной системы относительно X
методом Ньютона для решения нелинейных систем уравнений.

Вычислим матрицу Якоби размера (d+1)*n:
```
         | df[0]/dx0   ... df[0]/dx3   |
W(X,Y) = |     ...     ...    ...      |
         | df[n-1]/dx0 ... df[n-1]/dx3 |

                   {  2 * (x[k] — y[k], если k=0...2
df[i](X,Y)/dx[k] = {
                   { -2 * (x[3] — y[3], если k=3

```
Линейное приращение (дифференциал) функции F в небольшой окрестности точки
X0 может быть вычислено как произведение матрицы на вектор:
```
dF(X) = W(X0,Y) * (X-X0)
```

Для решения поставленной задачи потребуется реализовать:
 * функцию вычисления вектора F(X,Y);
 * функцию вычисления матрицы Якоби W(X,Y);
 * функцию решения переопределенной системы линейных уравнений
   W(X,Y) * dX = F относительно dX
 * функцию сложения векторов

Если есть предположение относительно координат искомых координат передатчика,
то x3 (или d0) может быть вычислено c усреднением по n.

## Ход решения для поиска X

1. Перейти от t[1]...t[n] к d[1]...d[n] и заполнить матрицу входных данных Y

2. Выбрать исходную точку для итеративного алгоритма: X = (x0`, y0`, z0`, d0)'

3. Вычислить невязку F = F(X,Y) - вектор размера n

4. Оценить невязку по модуля (размерность в метрах).
   Если невязка мала или исчерпан лимит итераций -> переход к п. 9

5. Вычислить матрицу Якоби W(X,Y)

6. Решить переопределенную систему линейных уравнений,
   найти поправку dX для точки X:  W(X,Y) * dX = F

7. Учесть поправку dX: X <= X - dX

8. Перейти к следующей итерации (к п.3)

9. Вернуть результаты (преобразовать d0 к t0)
